(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7014:function(e,s,n){Promise.resolve().then(n.bind(n,3500))},3500:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return Y}});var t=n(7437),l=n(4351),r=n(1925),a=n(6435),c=n(2265),i=n(3088),o=n(4528),d=n(5310);function x(){let[e,s]=(0,c.useState)(!1),{theme:n,setTheme:l}=(0,a.F)();(0,c.useEffect)(()=>{s(!0)},[]);let r=()=>{l("light"===n?"dark":"light")};return e?(0,t.jsx)("div",{children:(0,t.jsx)(d.A,{isIconOnly:!0,color:"warning",variant:"faded","aria-label":"theme",onClick:()=>r(),children:"light"===n?(0,t.jsx)(i.Z,{size:25}):(0,t.jsx)(o.Z,{size:25})})}):null}var u=n(4318),m=n(7330),h=n(594),j=n(1895),f=n(1718),p=n(9571),v=n(7782),g=n(7655),y=n(2913),N=n(2293),w=n(2549),b=n(6020),C=n(1412);function T(e,s){let n=s||{};return n.headers||(n.headers={"Content-Type":"application/json"}),fetch("http://localhost:3000/api"+e,n).then(e=>e.json())}var k=n(4040);let A="message-container";function E(e){let s;let n=(0,k.createRoot)(((s=document.getElementById(A))||((s=document.createElement("div")).setAttribute("id",A),document.body.appendChild(s)),s));n.render(function(e){let{message:s,type:n}=e;return(0,t.jsx)("div",{className:"fixed top-5 z-50",children:s})}(e))}var S={info:e=>{E({message:e,type:"info"})},success:e=>{E({message:e,type:"success"})},warning:e=>{E({message:e,type:"warning"})},error:e=>{E({message:e,type:"error"})}},P=function(e){var s;let{setIsRefresh:n}=e,{isOpen:a,onOpen:i,onOpenChange:o}=(0,u.q)(),[x,k]=(0,c.useState)(""),[A,E]=(0,c.useState)([]),[P,q]=(0,c.useState)(""),[O,F]=(0,c.useState)([]),{userId:Z}=(0,l.aC)(),_=null===(s=(0,l.aF)().user)||void 0===s?void 0:s.imageUrl,z=e=>{T("/topic",{method:"POST",body:JSON.stringify({userId:Z,avatar:_,content:x,images:O,options:A})}).then(s=>{e(),I(),n(new Date().getTime())})},I=()=>{k(""),E([]),q(""),F([])};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.A,{className:"mr-4",endContent:(0,t.jsx)(b.Z,{}),onPress:()=>{S.info("hahaha")},children:"消息"}),(0,t.jsx)(d.A,{color:"success",endContent:(0,t.jsx)(b.Z,{}),onPress:i,children:"发布"}),(0,t.jsx)(h.R,{isOpen:a,onOpenChange:o,children:(0,t.jsx)(j.A,{children:e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.k,{className:"flex flex-col gap-1",children:"发布话题"}),(0,t.jsxs)(p.I,{children:[(0,t.jsx)(v.Y,{label:"内容",placeholder:"写一篇话题吧",variant:"underlined",labelPlacement:"outside",value:x,onValueChange:k}),(0,t.jsx)(r.q,{x:2}),function(){let e=e=>{F(s=>[...s,e.info.secure_url])},s=e=>{F(s=>s.filter(s=>s!==e))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.lm,{uploadPreset:"ksvontss",onSuccess:s=>e(s),children:(0,t.jsx)("button",{className:"bg-secondary-400 hover:bg-secondary-700 text-white font-bold py-2 px-4 rounded",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(N.Z,{}),(0,t.jsx)("span",{className:"ml-2",children:"上传图片"})]})})}),O.map((e,n)=>(0,t.jsxs)("div",{className:"flex justify-between items-center px-4",children:[(0,t.jsx)("span",{className:"overflow-ellipsis overflow-hidden whitespace-nowrap",children:e}),(0,t.jsx)(w.Z,{className:"flex-shrink-0 ml-2 rounded-full cursor-pointer hover:text-red-400 hover:bg-gray-300",size:16,onClick:()=>s(e)})]},n))]})}(),(0,t.jsx)(r.q,{x:2}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(g.Y,{label:"输入选项",size:"sm",variant:"faded",value:P,onValueChange:q}),(0,t.jsx)(r.q,{x:2}),(0,t.jsx)(d.A,{color:"success",onClick:()=>{E([...A,P]),q("")},children:"添加"})]}),(0,t.jsx)(r.q,{x:2}),(0,t.jsx)("div",{className:"flex gap-2 flex-wrap",children:function(){let e=e=>{E(A.filter(s=>s!==e))};return A.map((s,n)=>(0,t.jsx)(m.z,{variant:"flat",onClose:()=>e(s),children:s},n))}()})]}),(0,t.jsxs)(y.R,{children:[(0,t.jsx)(d.A,{color:"danger",variant:"light",onPress:()=>{e(),I()},children:"取 消"}),(0,t.jsx)(d.A,{color:"primary",onPress:()=>z(e),children:"确 认"})]})]})})})]})},q=n(8522),O=function(){return(0,t.jsx)(d.A,{className:"fixed right-5 bottom-20",isIconOnly:!0,color:"warning",variant:"faded","aria-label":"theme",onPress:()=>{let e=document.documentElement.scrollTop||document.body.scrollTop,s=e/15;window.requestAnimationFrame(function e(){document.documentElement.scrollTop-=s,document.body.scrollTop-=s,(document.documentElement.scrollTop>0||document.body.scrollTop>0)&&window.requestAnimationFrame(e)})},children:(0,t.jsx)(q.Z,{})})},F=n(4042),Z=n(2658),_=n(1507),z=n(1026),I=n(1213),R=n(7836),J=n(3310),D=n(8312);function G(e){let{item:s}=e;return(0,t.jsxs)(F.u,{className:"pb-0 pt-2 px-4 flex-col items-start",children:[(0,t.jsxs)("p",{className:"text-tiny uppercase font-bold flex",children:[(0,t.jsx)(Z.h,{src:s.avatar}),(0,t.jsxs)("div",{className:"ml-2",children:[(0,t.jsx)("p",{children:s.userId}),(0,t.jsx)("small",{className:"text-default-500",children:s.createTime})]})]}),(0,t.jsx)("h4",{className:"text-small my-4 text-gray-500",children:s.content})]})}function U(e){let{item:s}=e;return(0,t.jsxs)(_.G,{className:"w-full",children:[(0,t.jsx)("div",{className:"flex items-center justify-start flex-row gap-4 flex-wrap pb-3",children:s.images.map((e,s)=>(0,t.jsx)(z.J,{isZoomed:!0,alt:"第".concat(s,"张图片"),className:"object-cover rounded-xl",src:e,width:270},s))}),(0,t.jsx)(I.X,{label:"Please select",children:s.options.map((e,s)=>(0,t.jsx)(R.J,{value:"buenos-aires",children:e.key},s))})]})}var V=function(e){let{topics:s,setTopics:n}=e;return(0,c.useEffect)(()=>{T("/topic",{method:"GET",cache:"no-cache"}).then(e=>{n(e.data)})},[n]),(0,t.jsx)("div",{className:"w-10/12 mx-4",children:s&&s.map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(J.w,{className:"px-4 py-6",children:[(0,t.jsx)(G,{item:e}),(0,t.jsx)(U,{item:e})]},e.id),s.length-1!==n?(0,t.jsx)(D.j,{className:"my-6"}):""]}))})};function Y(){let[e,s]=(0,c.useState)([]),[n,a]=(0,c.useState)(new Date().getTime());return(0,t.jsxs)("div",{children:[(0,t.jsx)("header",{className:"w-full py-4",children:(0,t.jsxs)("div",{className:"flex justify-end items-center",children:[(0,t.jsx)(P,{setIsRefresh:a}),(0,t.jsx)(r.q,{x:4}),(0,t.jsx)(x,{}),(0,t.jsx)(r.q,{x:4}),(0,t.jsx)(l.l8,{afterSignOutUrl:"/"})]})}),(0,t.jsx)("div",{className:"flex items-center justify-center m-4",children:(0,t.jsx)("main",{className:"flex flex-col items-center justify-center w-full border-x-2 sm:w-full md:w-10/12 lg:w-10/12",children:(0,t.jsx)(V,{topics:e,setTopics:s},n)})}),(0,t.jsx)(O,{})]})}}},function(e){e.O(0,[347,816,602,971,472,744],function(){return e(e.s=7014)}),_N_E=e.O()}]);